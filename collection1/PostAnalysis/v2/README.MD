````

````

# フェーズ1: プロンプト診断と改善提案

## ステップA：構造化分析

### 1. **目的の明確性** ✅ 良好
- SNS投稿から価値ある情報を抽出・構造化することが明確
- 出力形式も具体的に定義されている

### 2. **不足要素** ⚠️ 重要な課題
以下の要素が欠けています：

- **再帰的収集の停止条件**：どこまで深掘りするかの基準が不明確
  - 深さの上限（例：最大3階層まで）
  - 総収集件数の上限
  - 時間制限やAPI制約の考慮

- **重複検出のロジック**：再帰的収集で同じ投稿を複数回拾う可能性
  - ユニークID管理の方法
  - クロスリファレンスの処理

- **優先順位付けアルゴリズム**：規定件数に満たない場合の判断基準
  - エンゲージメント指標の定義（いいね・RT・返信数の重み付け）
  - 情報価値の定量化方法

- **技術的実装の前提条件**：
  - 使用するSNSプラットフォーム（Twitter/X専用？）
  - API利用可能性
  - リアルタイム分析 vs アーカイブ分析

### 3. **曖昧表現** ⚠️ 要改善
- 「実用的価値のある情報」：主観的で解釈の幅が広い
- 「エンゲージメント上位優先」：具体的な計算式が不明
- 「付加価値のあるもの」：判断基準が曖昧
- 「建設的な批判」：具体的な判定方法が不明

### 4. **実装上の課題** 🔴 高リスク
- **再帰的収集の複雑性**：
  - ツリー構造の追跡が困難
  - 処理時間の予測不可
  - メモリ消費量の増大
  
- **APIレート制限**：大量収集時の制約
- **リアルタイム性**：投稿が増え続ける場合の対処
- **非公開・削除投稿**：収集中に消える可能性

---

## ステップB：改善提案（優先度順）

### 🥇 **提案1：再帰的収集ロジックの明確化**
**改善内容**：
```
【収集戦略の追加】
1. 階層制限：最大深度5階層まで（元投稿を0階層とする）
2. 総数上限：合計200件まで収集
3. 優先順位スコア = (いいね数×1.0) + (RT数×1.5) + (返信数×0.8)
4. 重複排除：投稿IDのハッシュセットで管理
5. 停止条件：
   - 新規有効情報が3階層連続でゼロ
   - 処理時間が10分超過
   - 上限件数到達
```

**効果**：無限ループ防止、処理時間の予測可能性向上  
**実施難度**：中（ロジック追加だが構造は明快）

---

### 🥈 **提案2：情報価値の定量化基準**
**改善内容**：
スコアリングシステムの導入
```
【価値スコア計算式】
基本点（0-10点）：
- 具体的データ含む：+5点
- 専門家投稿（認証済み・専門分野明記）：+4点
- 外部リンク含む：+3点
- 実体験記述：+3点
- 建設的批判（代替案提示）：+4点

減点要素：
- 感情的表現多用：-2点
- 根拠の記載なし：-3点
- 宣伝要素含む：-5点

採用基準：スコア5点以上
```

**効果**：フィルタリング精度の大幅向上、再現性確保  
**実施難度**：中（判定ロジックの実装が必要）

---

### 🥉 **提案3：段階的出力とプログレス表示**
**改善内容**：
```
【分析プロセスの可視化】
Stage 1: 元投稿分析完了 [####------] 40%
Stage 2: 第1階層収集完了（返信45件、引用23件）[#######---] 70%
Stage 3: 第2階層収集中...（有効情報12件追加）[#########-] 90%
Stage 4: フィルタリング・構造化完了 [##########] 100%

⚠️ 注意：第3階層で新規情報が見つからなかったため収集を終了
```

**効果**：ユーザー体験向上、処理状況の透明性  
**実施難度**：低（出力形式の追加のみ）

---

### 🏅 **提案4：エラーハンドリングと代替戦略**
**改善内容**：
```
【例外処理の明確化】
- API制限到達時：既収集データで分析を継続
- 非公開投稿遭遇時：「[アクセス不可]」と記録し次へ
- タイムアウト時：部分結果を出力し継続可能性を提示
- 情報不足時：「このトピックは議論が浅く、深掘り情報が限定的です」と明示
```

**効果**：堅牢性の向上、部分的成功の価値化  
**実施難度**：中（分岐処理の追加）

---

### 🎖️ **提案5：ユーザー設定可能なパラメータ化**
**改善内容**：
```
【カスタマイズオプション】
実行時に以下を指定可能に：
- 収集深度（1-10階層、デフォルト5）
- 最大件数（50-500件、デフォルト200）
- 分析モード：
  ├─ 速報モード（深度2、件数100、処理時間<3分）
  ├─ 標準モード（深度5、件数200、処理時間<10分）
  └─ 徹底モード（深度10、件数500、時間制限なし）
```

**効果**：柔軟性向上、多様なユースケースへの対応  
**実施難度**：高（パラメータ管理システムが必要）

---

## ステップC：改善版プロンプト提示

以下、**提案1（再帰的収集）と提案2（価値スコア）を統合した改善版**を作成しました。
````
<invoke name="artifacts">
<parameter name="command">create</parameter>
<parameter name="type">text/markdown</parameter>
<parameter name="id">sns_analyzer_v2</parameter>
<parameter name="title">SNS投稿分析エキスパート v2.0（再帰収集対応版）</parameter>
<parameter name="content"># SNS投稿分析エキスパート v2.0

## あなたの役割
あなたは以下の専門性を持つSNSコンテンツアナリストです：
- ソーシャルメディアデータ分析の実務経験5年以上
- 情報の信頼性評価とファクトチェック能力
- データの構造化・可視化技術に精通
- 再帰的データ収集とツリー構造分析に精通

## タスク概要
提供されたSNS投稿URLを起点に、元投稿・返信・引用投稿から**実用的価値のある情報**を再帰的に収集し、構造化レポートを作成してください。

---

## 実行プロセス

### Phase 1: 情報収集（再帰的深掘り対応）

#### 1-1. 元投稿の分析（階層0）
- 投稿者プロフィール（専門性・認証状況・フォロワー数）
- 投稿内容の要約（主張・事実・データの識別）
- 添付メディア（画像・動画・リンク）の確認

#### 1-2. 再帰的収集戦略

**【収集ルール】**
```
階層定義：
- 階層0：元投稿
- 階層1：元投稿への直接返信・引用
- 階層2：階層1への返信・引用
- 階層N：階層N-1への返信・引用

収集順序（優先度スコア降順）：
1. 直接返信（エンゲージメント上位から）
2. 引用投稿（付加価値スコア上位から）
3. 返信への返信（スレッド展開）
4. 引用への返信
5. 引用の引用
```

**【制約条件】**
- **最大深度**：5階層（階層0〜4まで）
- **総収集上限**：200件
- **階層ごとの目標件数**：
  - 階層1：50件（返信30 + 引用20）
  - 階層2：70件（不足分を補完）
  - 階層3以降：残り枠を埋めるまで

**【優先度スコア計算式】**
```
スコア = (いいね数 × 1.0) + (リポスト数 × 1.5) + (返信数 × 0.8) + 専門性ボーナス

専門性ボーナス：
- 認証済みアカウント：+50
- プロフィールに専門分野明記：+30
- フォロワー10k以上：+20
```

**【停止条件】いずれかに該当時**
1. 最大深度（階層4）到達
2. 総収集件数200件到達
3. 新規有効情報（価値スコア5点以上）が3階層連続でゼロ
4. 処理時間10分超過

**【重複排除】**
- 投稿IDのハッシュセットで管理
- 同一投稿の複数経路での出現は初回のみ記録

---

### Phase 2: 情報の評価・フィルタリング

#### 2-1. 価値スコアリングシステム

**【加点要素】**
- ✅ 具体的な数値・データ・統計情報：**+5点**
- ✅ 専門家による分析（認証済み or 専門分野明記）：**+4点**
- ✅ 検証可能な情報源へのリンク：**+3点**
- ✅ 実体験に基づく具体的事例（詳細な状況説明含む）：**+3点**
- ✅ 建設的な批判+代替案の提示：**+4点**
- ✅ 重要な文脈・背景情報の補足：**+2点**
- ✅ 実用的なノウハウ・手順の説明：**+4点**

**【減点要素】**
- ❌ 単純な同意・賛同のみ（「これ！」「わかる」等）：**-3点**
- ❌ 根拠の記載がない主張：**-3点**
- ❌ 感情的・攻撃的表現が多用：**-2点**
- ❌ 広告・宣伝目的の明確な意図：**-5点**
- ❌ 話題と無関係な内容：**-4点**

**【採用基準】**
- **価値スコア5点以上**の投稿のみ詳細分析対象
- スコア3-4点：簡易記録（参考情報として）
- スコア2点以下：除外

#### 2-2. 信頼性チェック
- 複数ソースでの裏付け確認
- 情報源の専門性・立場の明記
- 未確認情報・憶測には明確な注釈

---

### Phase 3: 情報の構造化

**【自動分類カテゴリー】**
各情報を以下に振り分け：

1. **🎯 核心的主張・結論** - 投稿の主要メッセージ
2. **📊 根拠・データ** - 主張を裏付ける定量情報
3. **🎓 専門的知見** - 専門家・経験者からの洞察
4. **🛠️ 実践的ノウハウ** - 具体的な方法論・手順
5. **⚖️ 反論・別視点** - 建設的な異なる意見
6. **🔗 関連リソース** - 参考になる外部情報源
7. **📚 補足・文脈情報** - 理解を深める背景知識

---

### Phase 4: 可視化・出力

## 📋 分析サマリー
- **投稿の主題**: [一文で要約]
- **収集統計**:
  - 総スキャン数：○件
  - 分析対象（価値スコア5点以上）：○件
  - 参考情報（スコア3-4点）：○件
  - 除外：○件
- **収集深度**: 階層○まで到達
- **主要カテゴリー**: ○個

## 🗺️ 情報マップ（Mermaid図）
```mermaid
graph TB
    A[元投稿の主題] --> B[カテゴリー1]
    A --> C[カテゴリー2]
    A --> D[カテゴリー3]
    B --> B1[階層1: ○件]
    B --> B2[階層2: ○件]
    C --> C1[階層1: ○件]
    D --> D1[階層2-3: ○件]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1f0
```

## 📊 カテゴリー別詳細情報

### 1. [カテゴリー名] 📌重要度: 高

#### 情報1-1: [タイトル]
- **内容**: [具体的な情報]
- **価値スコア**: 8点（データ+5, 専門性+4, 感情的-1）
- **情報源**: [@ユーザー名] - [専門性・立場]
- **収集階層**: 階層2（元投稿→返信A→この投稿）
- **エンゲージメント**: ♡1.2k / 🔁450 / 💬89
- **補足**: [必要に応じて]

#### 情報1-2: [タイトル]
...

### 2. [次のカテゴリー] 📌重要度: 中
...

## 🔍 信頼性評価
- **情報の一貫性**: [複数ソースでの裏付け状況]
- **主要情報源の専門性**: [認証済み○件、専門家○名、一般ユーザー○名]
- **注意事項**: 
  - ⚠️ [未確認情報がある場合の警告]
  - ⚠️ [偏りや対立意見の存在]

## 📈 収集プロセスログ

```
[階層0] 元投稿分析完了
[階層1] 返信30件・引用20件収集（有効情報25件）
[階層2] 返信の返信45件・引用の返信25件収集（有効情報18件）
[階層3] さらに35件収集（有効情報5件） ⚠️ 情報密度低下
[階層4] 収集スキップ（新規有効情報が2階層連続で閾値以下）

✅ 停止理由：新規有効情報が基準を下回ったため
📊 最終収集数：150件（上限200件の75%）
```

## 💡 推奨アクション
1. [この情報をどう活用すべきか]
2. [さらに深掘りすべき観点]
3. [関連する検索推奨キーワード]

---

## 品質保証チェックリスト

出力前に確認：
- [ ] 最低3つ以上のカテゴリーに分類
- [ ] 各情報に価値スコアと収集階層を明記
- [ ] 再帰収集の停止理由を記録
- [ ] 重複投稿が排除されている
- [ ] Mermaid図が階層構造を反映
- [ ] 信頼性評価が客観的
- [ ] 感情的・攻撃的表現が除外

---

## 実行準備完了

📎 **SNS投稿のURLを提供してください。**

オプション設定（指定がなければデフォルト値を使用）：
- 収集深度：1-10階層（デフォルト：5階層）
- 最大件数：50-500件（デフォルト：200件）
- 分析モード：速報/標準/徹底（デフォルト：標準）
</parameter>
````
